!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="0bd42baa-f939-4603-a5a7-135a74745e18",e._sentryDebugIdIdentifier="sentry-dbid-0bd42baa-f939-4603-a5a7-135a74745e18")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[46],{80046:(e,t,n)=>{n.d(t,{A:()=>$});var a=n(37876),s=n(28902),r=n(92003),l=n(14232),o=n(12839),i=n(87376),c=n(48232),d=n(79270),m=n(44395),u=n(80553),p=n(59434),x=n(18952),y=n(3061),h=n(34034),g=n(6854),f=n(60230),C=n(43496),j=n(52894),b=n(67906),A=n(18334),v=n(87619),w=n(98594);function I(e){let{pgn:t,setPgn:n}=e;return(0,a.jsxs)(x.A,{fullWidth:!0,"data-sentry-element":"FormControl","data-sentry-component":"GamePgnInput","data-sentry-source-file":"gamePgnInput.tsx",children:[(0,a.jsx)(v.A,{label:"Enter PGN here...",variant:"outlined",multiline:!0,value:t,onChange:e=>n(e.target.value),rows:8,sx:{mb:2},"data-sentry-element":"TextField","data-sentry-source-file":"gamePgnInput.tsx"}),(0,a.jsxs)(s.A,{variant:"contained",component:"label",startIcon:(0,a.jsx)(w.In,{icon:"material-symbols:upload"}),"data-sentry-element":"Button","data-sentry-source-file":"gamePgnInput.tsx",children:["Upload PGN File",(0,a.jsx)("input",{type:"file",hidden:!0,accept:".pgn",onChange:e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!a)return;let s=new FileReader;s.onload=e=>{var t;n(null===(t=e.target)||void 0===t?void 0:t.result)},s.readAsText(a)}})]})]})}var G=n(64512),k=n(80721),L=n(43936),D=n(72147),P=n(60999);function B(e,t){let[n,a]=(0,l.useState)(e);return(0,l.useEffect)(()=>{if(e===n)return;if(!n){a(e);return}let s=setTimeout(()=>{a(e)},t);return()=>{clearTimeout(s)}},[e,t,n]),n}var T=n(41615),S=n(66703),N=n(80963),F=n(48677),W=n(62034),M=n(15852),E=n(63356);function R(e){let{timeControl:t}=e;return t?(0,a.jsx)(M.A,{title:"Time Control","data-sentry-element":"Tooltip","data-sentry-component":"TimeControlChip","data-sentry-source-file":"timeControlChip.tsx",children:(0,a.jsx)(E.A,{icon:(0,a.jsx)(w.In,{icon:"material-symbols:timer-outline"}),label:t,size:"small","data-sentry-element":"Chip","data-sentry-source-file":"timeControlChip.tsx"})}):null}function z(e){let{movesNb:t}=e;return t?(0,a.jsx)(M.A,{title:"Number of Moves",sx:{overflow:"hidden"},"data-sentry-element":"Tooltip","data-sentry-component":"MovesNbChip","data-sentry-source-file":"movesNbChip.tsx",children:(0,a.jsx)(E.A,{icon:(0,a.jsx)(w.In,{icon:"heroicons:hashtag-20-solid"}),label:"".concat(Math.ceil(t/2)," moves"),size:"small","data-sentry-element":"Chip","data-sentry-source-file":"movesNbChip.tsx"})}):null}function U(e){let{date:t}=e;return t?(0,a.jsx)(M.A,{title:"Date Played","data-sentry-element":"Tooltip","data-sentry-component":"DateChip","data-sentry-source-file":"dateChip.tsx",children:(0,a.jsx)(E.A,{icon:(0,a.jsx)(w.In,{icon:"material-symbols:calendar-today"}),label:t,size:"small","data-sentry-element":"Chip","data-sentry-source-file":"dateChip.tsx"})}):null}function _(e){let{result:t,perspectiveUserColor:n}=e,{label:s,color:r,bgColor:l}=q((0,S.A)(),n,t);return(0,a.jsx)(M.A,{title:s,"data-sentry-element":"Tooltip","data-sentry-component":"GameResultChip","data-sentry-source-file":"gameResultChip.tsx",children:(0,a.jsx)(E.A,{label:t,size:"small",sx:{color:r,backgroundColor:l,fontWeight:"600",minWidth:{sm:40},border:"1px solid ".concat(r,"20"),"& .MuiChip-icon":{color:r}},"data-sentry-element":"Chip","data-sentry-source-file":"gameResultChip.tsx"})})}let q=(e,t,n)=>"1-0"===n&&"white"===t||"0-1"===n&&"black"===t?{label:"1-0"===n?"White won":"Black won",color:e.palette.success.main,bgColor:"".concat(e.palette.success.main,"1A")}:"1-0"===n&&"black"===t||"0-1"===n&&"white"===t?{label:"1-0"===n?"White won":"Black won",color:e.palette.error.main,bgColor:"".concat(e.palette.error.main,"1A")}:"1/2-1/2"===n?{label:"Draw",color:e.palette.info.main,bgColor:"".concat(e.palette.info.main,"1A")}:{label:"Game in Progress",color:e.palette.text.secondary,bgColor:e.palette.action.hover},H=e=>{let{game:t,onClick:n,perspectiveUserColor:s}=e,l=(0,S.A)(),{white:o,black:i,result:c,timeControl:d,date:m,movesNb:u}=t,p="1-0"===c,x="0-1"===c;return(0,a.jsx)(N.Ay,{alignItems:"flex-start",sx:{borderRadius:2,mb:1.5,transition:"all 0.2s ease-in-out","&:hover":{backgroundColor:l.palette.action.hover,boxShadow:l.shadows[3]},border:"1px solid ".concat(l.palette.divider),cursor:"pointer"},onClick:n,"data-sentry-element":"ListItem","data-sentry-component":"GameItem","data-sentry-source-file":"index.tsx",children:(0,a.jsx)(F.A,{disableTypography:!0,primary:(0,a.jsxs)(W.A,{sx:{display:"flex",alignItems:"center",gap:{xs:1,sm:1.5},mb:1},children:[(0,a.jsxs)(r.A,{variant:"subtitle1",component:"span",noWrap:!0,sx:{fontWeight:"700",color:p?l.palette.success.main:l.palette.text.primary,opacity:p?1:x?.7:.8},children:[O(o)," (",o.rating,")"]}),(0,a.jsx)(r.A,{variant:"body2",component:"span",sx:{color:l.palette.text.secondary,fontWeight:"500"},children:"vs"}),(0,a.jsxs)(r.A,{variant:"subtitle1",component:"span",noWrap:!0,sx:{fontWeight:"700",color:x?l.palette.success.main:l.palette.text.primary,opacity:x?1:p?.7:.8},children:[O(i)," (",i.rating,")"]}),(0,a.jsx)(_,{result:c,perspectiveUserColor:s})]}),secondary:(0,a.jsxs)(W.A,{sx:{display:"flex",gap:1,alignItems:"center"},children:[(0,a.jsx)(R,{timeControl:d}),(0,a.jsx)(z,{movesNb:u}),(0,a.jsx)(U,{date:m})]}),"data-sentry-element":"ListItemText","data-sentry-source-file":"index.tsx"})})},O=e=>e.title?"".concat(e.title," ").concat(e.name):e.name;function V(e){let{onSelect:t}=e,[n,s]=(0,G.M)("chesscom-username",""),[r,o]=(0,l.useState)(""),[i,c]=(0,l.useState)(!1),d=(0,l.useMemo)(()=>"string"==typeof n?n.split(",").map(e=>e.trim()).filter(Boolean):[],[n]);!i&&d.length&&r.trim().toLowerCase()!=d[0].trim().toLowerCase()&&o(d[0].trim());let m=e=>{let t=e.trim();if(!t)return;let n=t.toLowerCase();s([t,...d.filter(e=>e.toLowerCase()!==n)].slice(0,8).join(","))},u=e=>{s(d.filter(t=>t!==e).join(","))},y=(e,t)=>{o((null!=t?t:"").trim()),c(!0)},h=B(r,300),{data:g,isFetching:f,isError:C}=(0,T.I)({queryKey:["CCUserGames",h],enabled:!!h,queryFn:e=>{let{signal:t}=e;return(0,k.V)(null!=h?h:"",t)},retry:1});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.A,{sx:{my:1,width:300},"data-sentry-element":"FormControl","data-sentry-source-file":"chessComInput.tsx",children:(0,a.jsx)(L.A,{freeSolo:!0,options:d,inputValue:r,onInputChange:y,onChange:y,renderOption:(e,t)=>{let{key:n,...s}=e;return(0,a.jsxs)("li",{...s,style:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingRight:8},children:[(0,a.jsx)("span",{children:t}),(0,a.jsx)(w.In,{icon:"mdi:close",style:{cursor:"pointer"},onClick:e=>{e.stopPropagation(),u(t)}})]},n)},renderInput:e=>(0,a.jsx)(v.A,{...e,label:"Enter your Chess.com username...",variant:"outlined"}),"data-sentry-element":"Autocomplete","data-sentry-source-file":"chessComInput.tsx"})}),h&&(0,a.jsx)(p.A,{container:!0,gap:2,justifyContent:"center",alignContent:"center",minHeight:100,size:12,children:f?(0,a.jsx)(D.A,{}):C?(0,a.jsx)("span",{style:{color:"salmon"},children:"User not found. Please check your username."}):(null==g?void 0:g.length)?(0,a.jsx)(P.A,{sx:{width:"100%"},children:g.map(e=>{let n=e.white.name.toLowerCase()===h.toLowerCase()?"white":"black";return(0,a.jsx)(H,{game:e,perspectiveUserColor:n,onClick:()=>{var n,a;let s=h.toLowerCase()!==(null===(a=e.black)||void 0===a?void 0:null===(n=a.name)||void 0===n?void 0:n.toLowerCase());t(e.pgn,s),m(h)}},e.id)})}):(0,a.jsx)("span",{style:{color:"salmon"},children:"No games found. Please check your username."})})]})}var K=n(71514);function Y(e){let{onSelect:t}=e,[n,s]=(0,G.M)("lichess-username",""),[r,o]=(0,l.useState)(""),[i,c]=(0,l.useState)(!1),d=(0,l.useMemo)(()=>"string"==typeof n?n.split(",").map(e=>e.trim()).filter(Boolean):[],[n]);!i&&d.length&&r.trim().toLowerCase()!=d[0].trim().toLowerCase()&&o(d[0].trim());let m=e=>{let t=e.trim();if(!t)return;let n=t.toLowerCase();s([t,...d.filter(e=>e.toLowerCase()!==n)].slice(0,8).join(","))},u=e=>{s(d.filter(t=>t!==e).join(","))},y=(e,t)=>{o((null!=t?t:"").trim()),c(!0)},h=B(r,500),{data:g,isFetching:f,isError:C}=(0,T.I)({queryKey:["LichessUserGames",h],enabled:!!h,queryFn:e=>{let{signal:t}=e;return(0,K.vc)(null!=h?h:"",t)},retry:1});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.A,{sx:{my:1,width:300},"data-sentry-element":"FormControl","data-sentry-source-file":"lichessInput.tsx",children:(0,a.jsx)(L.A,{freeSolo:!0,options:d,inputValue:r,onInputChange:y,onChange:y,renderOption:(e,t)=>{let{key:n,...s}=e;return(0,a.jsxs)("li",{...s,style:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingRight:8},children:[(0,a.jsx)("span",{children:t}),(0,a.jsx)(w.In,{icon:"mdi:close",style:{cursor:"pointer"},onClick:e=>{e.stopPropagation(),u(t)}})]},n)},renderInput:e=>(0,a.jsx)(v.A,{...e,label:"Enter your Lichess username...",variant:"outlined"}),"data-sentry-element":"Autocomplete","data-sentry-source-file":"lichessInput.tsx"})}),h&&(0,a.jsx)(p.A,{container:!0,gap:2,justifyContent:"center",alignContent:"center",minHeight:100,size:12,children:f?(0,a.jsx)(D.A,{}):C?(0,a.jsx)("span",{style:{color:"salmon"},children:"User not found. Please check your username."}):(null==g?void 0:g.length)?(0,a.jsx)(P.A,{sx:{width:"100%"},children:g.map(e=>{let n=e.white.name.toLowerCase()===h.toLowerCase()?"white":"black";return(0,a.jsx)(H,{game:e,perspectiveUserColor:n,onClick:()=>{let n=h.toLowerCase()!==e.black.name.toLowerCase();t(e.pgn,n),m(h)}},e.id)})}):(0,a.jsx)("span",{style:{color:"salmon"},children:"No games found. Please check your username."})})]})}var X=n(85278),J=n(31086);function Q(e){let{open:t,onClose:n,setGame:r}=e,[v,w]=(0,l.useState)(""),[k,L]=(0,G.M)("preferred-game-origin",c.By.ChessCom),[D,P]=(0,l.useState)(""),B=(0,l.useRef)(null),T=(0,X.Xr)(J.MA),{addGame:S}=(0,o.R)(),N=async(e,t)=>{if(e)try{let n=(0,i.w0)(e);(0,A.o)("loadedGame",{pgn:e}),r?await r(n):await S(n),T(null==t||t),F()}catch(e){console.error(e),B.current&&clearTimeout(B.current),P(e instanceof Error?"".concat(e.message," !"):"Invalid PGN: unknown error !"),B.current=setTimeout(()=>{P("")},3e3)}},F=()=>{w(""),P(""),B.current&&clearTimeout(B.current),n()};return(0,a.jsxs)(d.A,{open:t,onClose:F,maxWidth:"md",slotProps:{paper:{sx:{position:"fixed",top:0,width:"calc(100% - 10px)",marginY:{xs:"3vh",sm:5},maxHeight:{xs:"calc(100% - 5vh)",sm:"calc(100% - 64px)"}}}},"data-sentry-element":"Dialog","data-sentry-component":"NewGameDialog","data-sentry-source-file":"loadGameDialog.tsx",children:[(0,a.jsx)(m.A,{marginY:1,variant:"h5","data-sentry-element":"DialogTitle","data-sentry-source-file":"loadGameDialog.tsx",children:r?"Load a game":"Add a game to your database"}),(0,a.jsx)(u.A,{sx:{padding:{xs:2,md:3}},"data-sentry-element":"DialogContent","data-sentry-source-file":"loadGameDialog.tsx",children:(0,a.jsxs)(p.A,{container:!0,marginTop:1,alignItems:"center",justifyContent:"start",rowGap:2,"data-sentry-element":"Grid","data-sentry-source-file":"loadGameDialog.tsx",children:[(0,a.jsxs)(x.A,{sx:{my:1,mr:2,width:150},"data-sentry-element":"FormControl","data-sentry-source-file":"loadGameDialog.tsx",children:[(0,a.jsx)(y.A,{id:"dialog-select-label","data-sentry-element":"InputLabel","data-sentry-source-file":"loadGameDialog.tsx",children:"Game origin"}),(0,a.jsx)(h.A,{labelId:"dialog-select-label",id:"dialog-select",displayEmpty:!0,input:(0,a.jsx)(g.A,{label:"Game origin"}),value:null!=k?k:"",onChange:e=>{L(e.target.value),P("")},"data-sentry-element":"Select","data-sentry-source-file":"loadGameDialog.tsx",children:Object.entries(Z).map(e=>{let[t,n]=e;return(0,a.jsx)(f.A,{value:t,children:n},t)})})]}),k===c.By.Pgn&&(0,a.jsx)(I,{pgn:v,setPgn:w}),k===c.By.ChessCom&&(0,a.jsx)(V,{onSelect:N}),k===c.By.Lichess&&(0,a.jsx)(Y,{onSelect:N}),(0,a.jsx)(C.A,{open:!!D,"data-sentry-element":"Snackbar","data-sentry-source-file":"loadGameDialog.tsx",children:(0,a.jsx)(j.A,{onClose:()=>P(""),severity:"error",variant:"filled",sx:{width:"100%"},"data-sentry-element":"Alert","data-sentry-source-file":"loadGameDialog.tsx",children:D})})]})}),(0,a.jsxs)(b.A,{sx:{m:2},"data-sentry-element":"DialogActions","data-sentry-source-file":"loadGameDialog.tsx",children:[(0,a.jsx)(s.A,{variant:"outlined",onClick:F,"data-sentry-element":"Button","data-sentry-source-file":"loadGameDialog.tsx",children:"Cancel"}),k===c.By.Pgn&&(0,a.jsx)(s.A,{variant:"contained",sx:{marginLeft:2},onClick:()=>{N(v)},children:"Add"})]})]})}let Z={[c.By.ChessCom]:"Chess.com",[c.By.Lichess]:"Lichess.org",[c.By.Pgn]:"PGN"};function $(e){let{setGame:t,label:n,size:o}=e,[i,c]=(0,l.useState)(!1);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.A,{variant:"contained",onClick:()=>c(!0),size:o,"data-sentry-element":"Button","data-sentry-source-file":"loadGameButton.tsx",children:(0,a.jsx)(r.A,{fontSize:"0.9em",fontWeight:"500",lineHeight:"1.4em","data-sentry-element":"Typography","data-sentry-source-file":"loadGameButton.tsx",children:n||"Add game"})}),(0,a.jsx)(Q,{open:i,onClose:()=>c(!1),setGame:t,"data-sentry-element":"NewGameDialog","data-sentry-source-file":"loadGameButton.tsx"})]})}}}]);
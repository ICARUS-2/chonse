!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="a273e70b-674a-4872-a706-b48df1d6452d",e._sentryDebugIdIdentifier="sentry-dbid-a273e70b-674a-4872-a706-b48df1d6452d")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2],{50002:(e,t,n)=>{n.d(t,{A:()=>ea});var a=n(37876),s=n(28902),r=n(92003),l=n(14232),o=n(12839),i=n(87376),c=n(48232),d=n(79270),u=n(44395),m=n(80553),p=n(59434),y=n(18952),h=n(3061),x=n(34034),g=n(6854),f=n(60230),C=n(43496),j=n(52894),v=n(67906),b=n(18334),w=n(87619),A=n(98594);function I(e){let{pgn:t,setPgn:n}=e;return(0,a.jsxs)(y.A,{fullWidth:!0,"data-sentry-element":"FormControl","data-sentry-component":"GamePgnInput","data-sentry-source-file":"gamePgnInput.tsx",children:[(0,a.jsx)(w.A,{label:"Enter PGN here...",variant:"outlined",multiline:!0,value:t,onChange:e=>n(e.target.value),rows:8,sx:{mb:2},"data-sentry-element":"TextField","data-sentry-source-file":"gamePgnInput.tsx"}),(0,a.jsxs)(s.A,{variant:"contained",component:"label",startIcon:(0,a.jsx)(A.In,{icon:"material-symbols:upload"}),"data-sentry-element":"Button","data-sentry-source-file":"gamePgnInput.tsx",children:["Upload PGN File",(0,a.jsx)("input",{type:"file",hidden:!0,accept:".pgn",onChange:e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!a)return;let s=new FileReader;s.onload=e=>{var t;n(null===(t=e.target)||void 0===t?void 0:t.result)},s.readAsText(a)}})]})]})}var k=n(64512),G=n(80721),L=n(43936),D=n(72147),P=n(60999);function B(e,t){let[n,a]=(0,l.useState)(e);return(0,l.useEffect)(()=>{if(e===n)return;if(!n){a(e);return}let s=setTimeout(()=>{a(e)},t);return()=>{clearTimeout(s)}},[e,t,n]),n}var T=n(41615),S=n(66703),N=n(80963),R=n(48677),E=n(62034),F=n(15852),W=n(63356);function M(e){let{timeControl:t}=e;return t?(0,a.jsx)(F.A,{title:"Time Control","data-sentry-element":"Tooltip","data-sentry-component":"TimeControlChip","data-sentry-source-file":"timeControlChip.tsx",children:(0,a.jsx)(W.A,{icon:(0,a.jsx)(A.In,{icon:"material-symbols:timer-outline"}),label:t,size:"small","data-sentry-element":"Chip","data-sentry-source-file":"timeControlChip.tsx"})}):null}function U(e){let{movesNb:t}=e;return t?(0,a.jsx)(F.A,{title:"Number of Moves",sx:{overflow:"hidden"},"data-sentry-element":"Tooltip","data-sentry-component":"MovesNbChip","data-sentry-source-file":"movesNbChip.tsx",children:(0,a.jsx)(W.A,{icon:(0,a.jsx)(A.In,{icon:"heroicons:hashtag-20-solid"}),label:"".concat(Math.ceil(t/2)," moves"),size:"small","data-sentry-element":"Chip","data-sentry-source-file":"movesNbChip.tsx"})}):null}function z(e){let{date:t}=e;return t?(0,a.jsx)(F.A,{title:"Date Played","data-sentry-element":"Tooltip","data-sentry-component":"DateChip","data-sentry-source-file":"dateChip.tsx",children:(0,a.jsx)(W.A,{icon:(0,a.jsx)(A.In,{icon:"material-symbols:calendar-today"}),label:t,size:"small","data-sentry-element":"Chip","data-sentry-source-file":"dateChip.tsx"})}):null}function _(e){let{result:t,perspectiveUserColor:n}=e,{label:s,color:r,bgColor:l}=q((0,S.A)(),n,t);return(0,a.jsx)(F.A,{title:s,"data-sentry-element":"Tooltip","data-sentry-component":"GameResultChip","data-sentry-source-file":"gameResultChip.tsx",children:(0,a.jsx)(W.A,{label:t,size:"small",sx:{color:r,backgroundColor:l,fontWeight:"600",minWidth:{sm:40},border:"1px solid ".concat(r,"20"),"& .MuiChip-icon":{color:r}},"data-sentry-element":"Chip","data-sentry-source-file":"gameResultChip.tsx"})})}let q=(e,t,n)=>"1-0"===n&&"white"===t||"0-1"===n&&"black"===t?{label:"1-0"===n?"White won":"Black won",color:e.palette.success.main,bgColor:"".concat(e.palette.success.main,"1A")}:"1-0"===n&&"black"===t||"0-1"===n&&"white"===t?{label:"1-0"===n?"White won":"Black won",color:e.palette.error.main,bgColor:"".concat(e.palette.error.main,"1A")}:"1/2-1/2"===n?{label:"Draw",color:e.palette.info.main,bgColor:"".concat(e.palette.info.main,"1A")}:{label:"Game in Progress",color:e.palette.text.secondary,bgColor:e.palette.action.hover};var H=n(1588);class V{static generateGameUrl(e,t,n){let a=window.location.origin;return"".concat(a).concat(H.o,"/?gameId=").concat(t,"&username=").concat(n,"&site=").concat(e)}}var O=n(89848);let K=e=>{var t;let{game:n,onClick:l,perspectiveUserColor:o}=e,i=(0,S.A)(),{white:d,black:u,result:m,timeControl:p,date:y,movesNb:h}=n,x="1-0"===m,g="0-1"===m;return(0,a.jsx)(N.Ay,{alignItems:"flex-start",sx:{borderRadius:2,mb:1.5,transition:"all 0.2s ease-in-out","&:hover":{backgroundColor:i.palette.action.hover,boxShadow:i.shadows[3]},border:"1px solid ".concat(i.palette.divider),cursor:"pointer"},onClick:l,"data-sentry-element":"ListItem","data-sentry-component":"GameItem","data-sentry-source-file":"index.tsx",children:(0,a.jsx)(R.A,{disableTypography:!0,primary:(0,a.jsxs)(E.A,{sx:{display:"flex",alignItems:"center",gap:{xs:1,sm:1.5},mb:1},children:[(0,a.jsxs)(r.A,{variant:"subtitle1",component:"span",noWrap:!0,sx:{fontWeight:"700",color:x?i.palette.success.main:i.palette.text.primary,opacity:x?1:g?.7:.8},children:[X(d)," (",d.rating,")"]}),(0,a.jsx)(r.A,{variant:"body2",component:"span",sx:{color:i.palette.text.secondary,fontWeight:"500"},children:"vs"}),(0,a.jsxs)(r.A,{variant:"subtitle1",component:"span",noWrap:!0,sx:{fontWeight:"700",color:g?i.palette.success.main:i.palette.text.primary,opacity:g?1:x?.7:.8},children:[X(u)," (",u.rating,")"]}),(0,a.jsx)(_,{result:m,perspectiveUserColor:o}),(null===(t=n.url)||void 0===t?void 0:t.includes("www.chess.com"))&&(0,a.jsx)(s.A,{variant:"contained",onClick:e=>{var t,a,s;e.stopPropagation();let r="",l="",i="";if(null===(t=n.url)||void 0===t?void 0:t.includes("www.chess.com")){r=c.By.ChessCom;let e=null===(a=n.url)||void 0===a?void 0:a.split("/");switch(l=null!==(s=null==e?void 0:e.at(-1))&&void 0!==s?s:"",o){case"white":i=n.white.name;break;case"black":i=n.black.name}let t=V.generateGameUrl(r,l,i);navigator.clipboard.writeText(t).then(()=>{O.oR.success("Successfully copied link",{theme:"dark",autoClose:2e3})}).catch(e=>{O.oR.warning("Error copying link: ".concat(e))})}},children:"Copy Game Link"})]}),secondary:(0,a.jsxs)(E.A,{sx:{display:"flex",gap:1,alignItems:"center"},children:[(0,a.jsx)(M,{timeControl:p}),(0,a.jsx)(U,{movesNb:h}),(0,a.jsx)(z,{date:y})]}),"data-sentry-element":"ListItemText","data-sentry-source-file":"index.tsx"})})},X=e=>e.title?"".concat(e.title," ").concat(e.name):e.name;function Y(e){let{onSelect:t}=e,[n,s]=(0,k.M)("chesscom-username",""),[r,o]=(0,l.useState)(""),[i,c]=(0,l.useState)(!1),d=(0,l.useMemo)(()=>"string"==typeof n?n.split(",").map(e=>e.trim()).filter(Boolean):[],[n]);!i&&d.length&&r.trim().toLowerCase()!=d[0].trim().toLowerCase()&&o(d[0].trim());let u=e=>{let t=e.trim();if(!t)return;let n=t.toLowerCase();s([t,...d.filter(e=>e.toLowerCase()!==n)].slice(0,8).join(","))},m=e=>{s(d.filter(t=>t!==e).join(","))},h=(e,t)=>{o((null!=t?t:"").trim()),c(!0)},x=B(r,300),{data:g,isFetching:f,isError:C}=(0,T.I)({queryKey:["CCUserGames",x],enabled:!!x,queryFn:e=>{let{signal:t}=e;return(0,G.V)(null!=x?x:"",t)},retry:1});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(y.A,{sx:{my:1,width:300},"data-sentry-element":"FormControl","data-sentry-source-file":"chessComInput.tsx",children:(0,a.jsx)(L.A,{freeSolo:!0,options:d,inputValue:r,onInputChange:h,onChange:h,renderOption:(e,t)=>{let{key:n,...s}=e;return(0,a.jsxs)("li",{...s,style:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingRight:8},children:[(0,a.jsx)("span",{children:t}),(0,a.jsx)(A.In,{icon:"mdi:close",style:{cursor:"pointer"},onClick:e=>{e.stopPropagation(),m(t)}})]},n)},renderInput:e=>(0,a.jsx)(w.A,{...e,label:"Enter your Chess.com username...",variant:"outlined"}),"data-sentry-element":"Autocomplete","data-sentry-source-file":"chessComInput.tsx"})}),x&&(0,a.jsx)(p.A,{container:!0,gap:2,justifyContent:"center",alignContent:"center",minHeight:100,size:12,children:f?(0,a.jsx)(D.A,{}):C?(0,a.jsx)("span",{style:{color:"salmon"},children:"User not found. Please check your username."}):(null==g?void 0:g.length)?(0,a.jsx)(P.A,{sx:{width:"100%"},children:g.map(e=>{let n=e.white.name.toLowerCase()===x.toLowerCase()?"white":"black";return(0,a.jsx)(K,{game:e,perspectiveUserColor:n,onClick:()=>{var n,a;let s=x.toLowerCase()!==(null===(a=e.black)||void 0===a?void 0:null===(n=a.name)||void 0===n?void 0:n.toLowerCase());t(e.pgn,s),u(x)}},e.id)})}):(0,a.jsx)("span",{style:{color:"salmon"},children:"No games found. Please check your username."})})]})}var J=n(71514);function Q(e){let{onSelect:t}=e,[n,s]=(0,k.M)("lichess-username",""),[r,o]=(0,l.useState)(""),[i,c]=(0,l.useState)(!1),d=(0,l.useMemo)(()=>"string"==typeof n?n.split(",").map(e=>e.trim()).filter(Boolean):[],[n]);!i&&d.length&&r.trim().toLowerCase()!=d[0].trim().toLowerCase()&&o(d[0].trim());let u=e=>{let t=e.trim();if(!t)return;let n=t.toLowerCase();s([t,...d.filter(e=>e.toLowerCase()!==n)].slice(0,8).join(","))},m=e=>{s(d.filter(t=>t!==e).join(","))},h=(e,t)=>{o((null!=t?t:"").trim()),c(!0)},x=B(r,500),{data:g,isFetching:f,isError:C}=(0,T.I)({queryKey:["LichessUserGames",x],enabled:!!x,queryFn:e=>{let{signal:t}=e;return(0,J.vc)(null!=x?x:"",t)},retry:1});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(y.A,{sx:{my:1,width:300},"data-sentry-element":"FormControl","data-sentry-source-file":"lichessInput.tsx",children:(0,a.jsx)(L.A,{freeSolo:!0,options:d,inputValue:r,onInputChange:h,onChange:h,renderOption:(e,t)=>{let{key:n,...s}=e;return(0,a.jsxs)("li",{...s,style:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingRight:8},children:[(0,a.jsx)("span",{children:t}),(0,a.jsx)(A.In,{icon:"mdi:close",style:{cursor:"pointer"},onClick:e=>{e.stopPropagation(),m(t)}})]},n)},renderInput:e=>(0,a.jsx)(w.A,{...e,label:"Enter your Lichess username...",variant:"outlined"}),"data-sentry-element":"Autocomplete","data-sentry-source-file":"lichessInput.tsx"})}),x&&(0,a.jsx)(p.A,{container:!0,gap:2,justifyContent:"center",alignContent:"center",minHeight:100,size:12,children:f?(0,a.jsx)(D.A,{}):C?(0,a.jsx)("span",{style:{color:"salmon"},children:"User not found. Please check your username."}):(null==g?void 0:g.length)?(0,a.jsx)(P.A,{sx:{width:"100%"},children:g.map(e=>{let n=e.white.name.toLowerCase()===x.toLowerCase()?"white":"black";return(0,a.jsx)(K,{game:e,perspectiveUserColor:n,onClick:()=>{let n=x.toLowerCase()!==e.black.name.toLowerCase();t(e.pgn,n),u(x)}},e.id)})}):(0,a.jsx)("span",{style:{color:"salmon"},children:"No games found. Please check your username."})})]})}var Z=n(85278),$=n(31086),ee=n(89099);function et(e){let{open:t,onClose:n,setGame:r}=e,[w,A]=(0,l.useState)(""),[L,D]=(0,k.M)("preferred-game-origin",c.By.ChessCom),[P,B]=(0,l.useState)(""),T=(0,l.useRef)(null),S=(0,Z.Xr)($.MA),{addGame:N}=(0,o.R)(),R=(0,ee.useRouter)(),E=async(e,t)=>{if(e)try{let n=(0,i.w0)(e);(0,b.o)("loadedGame",{pgn:e}),r?await r(n):await N(n),S(null==t||t),F()}catch(e){console.error(e),T.current&&clearTimeout(T.current),B(e instanceof Error?"".concat(e.message," !"):"Invalid PGN: unknown error !"),T.current=setTimeout(()=>{B("")},3e3)}},F=()=>{A(""),B(""),T.current&&clearTimeout(T.current),n()};return(0,l.useEffect)(()=>{let{site:e,gameId:t,username:n}=R.query;if(!e||!t||!n)return;let a=Array.isArray(n)?n[0]:n,s=Array.isArray(t)?t[0]:t,r=Array.isArray(e)?e[0]:e,l="";"chesscom"===r&&(0,G.V)(a).then(e=>{e.forEach(e=>{var t;let n=null===(t=e.url)||void 0===t?void 0:t.split("/");(null==n?void 0:n.at(-1))===s&&(A(l=e.pgn),E(l))})})},[R.isReady]),(0,a.jsxs)(d.A,{open:t,onClose:F,maxWidth:"md",slotProps:{paper:{sx:{position:"fixed",top:0,width:"calc(100% - 10px)",marginY:{xs:"3vh",sm:5},maxHeight:{xs:"calc(100% - 5vh)",sm:"calc(100% - 64px)"}}}},"data-sentry-element":"Dialog","data-sentry-component":"NewGameDialog","data-sentry-source-file":"loadGameDialog.tsx",children:[(0,a.jsx)(u.A,{marginY:1,variant:"h5","data-sentry-element":"DialogTitle","data-sentry-source-file":"loadGameDialog.tsx",children:r?"Load a game":"Add a game to your database"}),(0,a.jsx)(m.A,{sx:{padding:{xs:2,md:3}},"data-sentry-element":"DialogContent","data-sentry-source-file":"loadGameDialog.tsx",children:(0,a.jsxs)(p.A,{container:!0,marginTop:1,alignItems:"center",justifyContent:"start",rowGap:2,"data-sentry-element":"Grid","data-sentry-source-file":"loadGameDialog.tsx",children:[(0,a.jsxs)(y.A,{sx:{my:1,mr:2,width:150},"data-sentry-element":"FormControl","data-sentry-source-file":"loadGameDialog.tsx",children:[(0,a.jsx)(h.A,{id:"dialog-select-label","data-sentry-element":"InputLabel","data-sentry-source-file":"loadGameDialog.tsx",children:"Game origin"}),(0,a.jsx)(x.A,{labelId:"dialog-select-label",id:"dialog-select",displayEmpty:!0,input:(0,a.jsx)(g.A,{label:"Game origin"}),value:null!=L?L:"",onChange:e=>{D(e.target.value),B("")},"data-sentry-element":"Select","data-sentry-source-file":"loadGameDialog.tsx",children:Object.entries(en).map(e=>{let[t,n]=e;return(0,a.jsx)(f.A,{value:t,children:n},t)})})]}),L===c.By.Pgn&&(0,a.jsx)(I,{pgn:w,setPgn:A}),L===c.By.ChessCom&&(0,a.jsx)(Y,{onSelect:E}),L===c.By.Lichess&&(0,a.jsx)(Q,{onSelect:E}),(0,a.jsx)(C.A,{open:!!P,"data-sentry-element":"Snackbar","data-sentry-source-file":"loadGameDialog.tsx",children:(0,a.jsx)(j.A,{onClose:()=>B(""),severity:"error",variant:"filled",sx:{width:"100%"},"data-sentry-element":"Alert","data-sentry-source-file":"loadGameDialog.tsx",children:P})})]})}),(0,a.jsxs)(v.A,{sx:{m:2},"data-sentry-element":"DialogActions","data-sentry-source-file":"loadGameDialog.tsx",children:[(0,a.jsx)(s.A,{variant:"outlined",onClick:F,"data-sentry-element":"Button","data-sentry-source-file":"loadGameDialog.tsx",children:"Cancel"}),L===c.By.Pgn&&(0,a.jsx)(s.A,{variant:"contained",sx:{marginLeft:2},onClick:()=>{E(w)},children:"Add"})]})]})}let en={[c.By.ChessCom]:"Chess.com",[c.By.Lichess]:"Lichess.org",[c.By.Pgn]:"PGN"};function ea(e){let{setGame:t,label:n,size:o}=e,[i,c]=(0,l.useState)(!1),d=(0,Z.Xr)($.S1);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.A,{variant:"contained",onClick:()=>{c(!0),d("")},size:o,"data-sentry-element":"Button","data-sentry-source-file":"loadGameButton.tsx",children:(0,a.jsx)(r.A,{fontSize:"0.9em",fontWeight:"500",lineHeight:"1.4em","data-sentry-element":"Typography","data-sentry-source-file":"loadGameButton.tsx",children:n||"Add game"})}),(0,a.jsx)(et,{open:i,onClose:()=>c(!1),setGame:t,"data-sentry-element":"NewGameDialog","data-sentry-source-file":"loadGameButton.tsx"})]})}}}]);
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="489844b3-a1c9-40c3-aaf1-8f3857e2a9b3",e._sentryDebugIdIdentifier="sentry-dbid-489844b3-a1c9-40c3-aaf1-8f3857e2a9b3")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[174],{23876:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/play",function(){return n(49721)}])},49721:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>et});var a=n(37876),s=n(59696),r=n(85278),i=n(23993),l=n(48232),o=n(22277),d=n(99542);let c=(0,d.eU)(new o.d$),m=(0,d.eU)({}),g=(0,d.eU)(l.Q1.White),u=(0,d.eU)(i.T3),y=(0,d.eU)(1320),f=(0,d.eU)(!1);var x=n(72359),h=n(14232),p=n(57705),j=n(80542),v=n(87376),b=n(15888);let A=(e,t)=>{let n=(0,r.md)(e),[a,s]=(0,r.fp)(t);return(0,h.useEffect)(()=>{s({lastMove:n.history({verbose:!0}).at(-1)})},[n]),a};var w=n(55246),S=n(94309);function C(){let e=(0,p.l)(),t=(0,r.md)(u),n=(0,j.K)(t),s=(0,r.md)(c),{white:i,black:l}=(0,w.K)(c),o=(0,r.md)(g),{playMove:d}=(0,x.j)(c),C=(0,r.md)(y),D=(0,r.md)(f),k=s.fen(),I=s.isGameOver();(0,h.useEffect)(()=>((async()=>{if(!(null==n?void 0:n.getIsReady())||s.turn()===o||I||!D)return;let e=(0,S.yy)(1e3),t=await n.getEngineNextMove(k,C);await e,t&&d((0,v.vc)(t))})(),()=>{null==n||n.stopAllCurrentJobs()}),[k,D]);let B=(0,h.useMemo)(()=>{var t;let n=e.width,a=e.height;return(null===(t=window)||void 0===t?void 0:t.innerWidth)<900?Math.min(n,a-150):Math.min(n-300,.83*a)},[e]);return A(c,m),(0,a.jsx)(b.h,{id:"PlayBoard",canPlay:!!D&&o,gameAtom:c,boardSize:B,whitePlayer:i,blackPlayer:l,boardOrientation:o,currentPositionAtom:m,"data-sentry-element":"Board","data-sentry-component":"BoardContainer","data-sentry-source-file":"board.tsx"})}var D=n(59434),k=n(92003),I=n(72147),B=n(28902);function G(){let e=(0,r.md)(c),{goToMove:t,undoMove:n}=(0,x.j)(c),s=(0,r.md)(g);return(0,a.jsx)(B.A,{variant:"outlined",onClick:()=>{let a=e.history(),r=e.turn();if("w"===r&&s===l.Q1.White||"b"===r&&s===l.Q1.Black){if(a.length<2)return;t(a.length-2,e)}else{if(!a.length)return;n()}},"data-sentry-element":"Button","data-sentry-component":"UndoMoveButton","data-sentry-source-file":"undoMoveButton.tsx",children:"Undo your last move"})}function P(){let e=(0,r.md)(c),[t,n]=(0,r.fp)(f);return((0,h.useEffect)(()=>{e.isGameOver()&&n(!1)},[e,n]),t)?(0,a.jsxs)(D.A,{container:!0,justifyContent:"center",alignItems:"center",gap:2,size:12,"data-sentry-element":"Grid","data-sentry-component":"GameInProgress","data-sentry-source-file":"gameInProgress.tsx",children:[(0,a.jsxs)(D.A,{container:!0,justifyContent:"center",alignItems:"center",gap:2,size:12,"data-sentry-element":"Grid","data-sentry-source-file":"gameInProgress.tsx",children:[(0,a.jsx)(k.A,{"data-sentry-element":"Typography","data-sentry-source-file":"gameInProgress.tsx",children:"Game in progress"}),(0,a.jsx)(I.A,{size:20,color:"info","data-sentry-element":"CircularProgress","data-sentry-source-file":"gameInProgress.tsx"})]}),(0,a.jsx)(D.A,{container:!0,justifyContent:"center",alignItems:"center",size:12,"data-sentry-element":"Grid","data-sentry-source-file":"gameInProgress.tsx",children:(0,a.jsx)(G,{"data-sentry-element":"UndoMoveButton","data-sentry-source-file":"gameInProgress.tsx"})}),(0,a.jsx)(D.A,{container:!0,justifyContent:"center",alignItems:"center",size:12,"data-sentry-element":"Grid","data-sentry-source-file":"gameInProgress.tsx",children:(0,a.jsx)(B.A,{variant:"outlined",onClick:()=>{n(!1)},"data-sentry-element":"Button","data-sentry-source-file":"gameInProgress.tsx",children:"Resign"})})]}):null}var W=n(12839),_=n(89099);function E(){let e=(0,r.md)(c),t=(0,r.md)(g),n=(0,r.md)(f),{addGame:s}=(0,W.R)(),i=(0,_.useRouter)();if(n||!e.history().length)return null;let o=async()=>{let n=(0,v.nt)(e,{resigned:e.isGameOver()?void 0:t}),a=await s(n);i.push({pathname:"/",query:{gameId:a}})};return(0,a.jsxs)(D.A,{container:!0,justifyContent:"center",alignItems:"center",gap:2,size:12,"data-sentry-element":"Grid","data-sentry-component":"GameRecap","data-sentry-source-file":"gameRecap.tsx",children:[(0,a.jsx)(D.A,{container:!0,justifyContent:"center",size:12,"data-sentry-element":"Grid","data-sentry-source-file":"gameRecap.tsx",children:(0,a.jsx)(k.A,{"data-sentry-element":"Typography","data-sentry-source-file":"gameRecap.tsx",children:(()=>{if(e.isCheckmate()){let n=("w"===e.turn()?l.Q1.Black:l.Q1.White)===t?"You":"Stockfish";return"".concat(n," won by checkmate !")}return e.isInsufficientMaterial()?"Draw by insufficient material":e.isStalemate()?"Draw by stalemate":e.isThreefoldRepetition()?"Draw by threefold repetition":e.isDraw()?"Draw by fifty-move rule":"You resigned"})()})}),(0,a.jsx)(B.A,{variant:"outlined",onClick:o,"data-sentry-element":"Button","data-sentry-source-file":"gameRecap.tsx",children:"Open game analysis"})]})}var Q=n(46852),z=n(79270),R=n(44395),T=n(80553),M=n(18952),N=n(3061),U=n(34034),O=n(6854),F=n(60230),Y=n(76790),H=n(71918),q=n(86198),L=n(87619),X=n(67906),K=n(89665),$=n(30333),J=n(3642),V=n(98510);function Z(e){let{open:t,onClose:n}=e,[s,o]=(0,K.v)("engine-elo",y),[d,m]=(0,K.v)("engine-play-name",u),[p,j]=(0,r.fp)(g),b=(0,r.Xr)(f),{reset:A}=(0,x.j)(c),[w,S]=(0,h.useState)(""),[C,I]=(0,h.useState)("");(0,h.useEffect)(()=>{(0,J.N9)(d)||(V.m.isSupported()?m(l.Qz.Stockfish16_1Lite):m(l.Qz.Stockfish11))},[m,d]);let G=()=>{n(),S(""),I("")};return(0,a.jsxs)(z.A,{open:t,onClose:G,maxWidth:"md",fullWidth:!0,"data-sentry-element":"Dialog","data-sentry-component":"GameSettingsDialog","data-sentry-source-file":"gameSettingsDialog.tsx",children:[(0,a.jsx)(R.A,{marginY:1,variant:"h5","data-sentry-element":"DialogTitle","data-sentry-source-file":"gameSettingsDialog.tsx",children:"Set game parameters"}),(0,a.jsxs)(T.A,{sx:{paddingBottom:0},"data-sentry-element":"DialogContent","data-sentry-source-file":"gameSettingsDialog.tsx",children:[(0,a.jsxs)(k.A,{"data-sentry-element":"Typography","data-sentry-source-file":"gameSettingsDialog.tsx",children:[i.H[i.T3].small," is the default engine if your device support its requirements. It offers the best balance between speed and strength. ",i.H[i.RS].small," is the strongest engine available, note that it requires a one time download of 75MB."]}),(0,a.jsxs)(D.A,{marginTop:4,container:!0,justifyContent:"center",alignItems:"center",rowGap:3,size:12,"data-sentry-element":"Grid","data-sentry-source-file":"gameSettingsDialog.tsx",children:[(0,a.jsx)(D.A,{container:!0,justifyContent:"center",size:12,"data-sentry-element":"Grid","data-sentry-source-file":"gameSettingsDialog.tsx",children:(0,a.jsxs)(M.A,{variant:"outlined","data-sentry-element":"FormControl","data-sentry-source-file":"gameSettingsDialog.tsx",children:[(0,a.jsx)(N.A,{id:"dialog-select-label","data-sentry-element":"InputLabel","data-sentry-source-file":"gameSettingsDialog.tsx",children:"Bot's engine"}),(0,a.jsx)(U.A,{labelId:"dialog-select-label",id:"dialog-select",displayEmpty:!0,input:(0,a.jsx)(O.A,{label:"Engine"}),value:d,onChange:e=>m(e.target.value),sx:{width:280,maxWidth:"100%"},"data-sentry-element":"Select","data-sentry-source-file":"gameSettingsDialog.tsx",children:Object.values(l.Qz).map(e=>(0,a.jsx)(F.A,{value:e,disabled:!(0,J.N9)(e),children:i.H[e].full},e))})]})}),(0,a.jsx)(Q.A,{label:"Bot Elo rating",value:s,setValue:o,min:1320,max:3190,step:10,marksFilter:374,"data-sentry-element":"Slider","data-sentry-source-file":"gameSettingsDialog.tsx"}),(0,a.jsx)(Y.A,{"data-sentry-element":"FormGroup","data-sentry-source-file":"gameSettingsDialog.tsx",children:(0,a.jsx)(H.A,{control:(0,a.jsx)(q.A,{color:"default",checked:p===l.Q1.White,onChange:e=>{j(e.target.checked?l.Q1.White:l.Q1.Black)}}),label:p===l.Q1.White?"You play as White":"You play as Black","data-sentry-element":"FormControlLabel","data-sentry-source-file":"gameSettingsDialog.tsx"})}),(0,a.jsx)(M.A,{fullWidth:!0,"data-sentry-element":"FormControl","data-sentry-source-file":"gameSettingsDialog.tsx",children:(0,a.jsx)(L.A,{label:"Optional starting position (FEN or PGN)",variant:"outlined",multiline:!0,value:w,onChange:e=>S(e.target.value),"data-sentry-element":"TextField","data-sentry-source-file":"gameSettingsDialog.tsx"})}),C&&(0,a.jsx)(M.A,{fullWidth:!0,children:(0,a.jsx)(k.A,{color:"salmon",textAlign:"center",marginTop:1,children:C})})]})]}),(0,a.jsxs)(X.A,{sx:{m:2},"data-sentry-element":"DialogActions","data-sentry-source-file":"gameSettingsDialog.tsx",children:[(0,a.jsx)(B.A,{variant:"outlined",sx:{marginRight:2},onClick:G,"data-sentry-element":"Button","data-sentry-source-file":"gameSettingsDialog.tsx",children:"Cancel"}),(0,a.jsx)(B.A,{variant:"contained",onClick:()=>{I("");try{let e=w.trim(),t=e.startsWith("[")?(0,v.w0)(e).fen():e||void 0;A({white:{name:p===l.Q1.White?"You":i.H[d].small,rating:p===l.Q1.White?void 0:s},black:{name:p===l.Q1.Black?"You":i.H[d].small,rating:p===l.Q1.Black?void 0:s},fen:t})}catch(e){console.error(e),I(e instanceof Error?"".concat(e.message," !"):"Unknown error while parsing input !");return}b(!0),G(),(0,$.$)("play_game",{engine:d,engineElo:s,playerColor:p})},"data-sentry-element":"Button","data-sentry-source-file":"gameSettingsDialog.tsx",children:"Start game"})]})]})}function ee(){let[e,t]=(0,h.useState)(!1),n=(0,r.md)(c);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(B.A,{variant:"contained",onClick:()=>t(!0),"data-sentry-element":"Button","data-sentry-source-file":"gameSettingsButton.tsx",children:n.history().length?"Start new game":"Start game"}),(0,a.jsx)(Z,{open:e,onClose:()=>t(!1),"data-sentry-element":"GameSettingsDialog","data-sentry-source-file":"gameSettingsButton.tsx"})]})}function et(){let e=(0,r.md)(f);return(0,a.jsxs)(D.A,{container:!0,gap:4,justifyContent:"space-evenly",alignItems:"start","data-sentry-element":"Grid","data-sentry-component":"Play","data-sentry-source-file":"play.tsx",children:[(0,a.jsx)(s.s,{title:"Chesskit Play vs Stockfish","data-sentry-element":"PageTitle","data-sentry-source-file":"play.tsx"}),(0,a.jsx)(C,{"data-sentry-element":"Board","data-sentry-source-file":"play.tsx"}),(0,a.jsxs)(D.A,{container:!0,marginTop:{xs:0,md:"2.5em"},justifyContent:"center",alignItems:"center",borderRadius:2,border:1,borderColor:"secondary.main",size:{xs:12,md:"grow"},sx:{backgroundColor:"secondary.main",borderColor:"primary.main",borderWidth:2,boxShadow:"0 2px 10px rgba(0, 0, 0, 0.5)"},padding:3,rowGap:3,style:{maxWidth:"400px"},"data-sentry-element":"Grid","data-sentry-source-file":"play.tsx",children:[(0,a.jsx)(P,{"data-sentry-element":"GameInProgress","data-sentry-source-file":"play.tsx"}),!e&&(0,a.jsx)(ee,{}),(0,a.jsx)(E,{"data-sentry-element":"GameRecap","data-sentry-source-file":"play.tsx"})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[774,493,302,125,133,975,636,593,792],()=>t(23876)),_N_E=e.O()}]);